<?xml version="1.0" encoding="UTF-8"?>
<metamorph xmlns="http://www.culturegraph.org/metamorph" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	version="1">
	<!-- beware: the sequence of the rules are semantically important! Don't change the order. -->
	<!-- Aleph MAB differs from MAB in that: -->
	<!-- an indicator2 exists -->
	<!-- most fields have a subfield 'a' -->
	<!-- => structure of alehp MAB: $field$indicator1$indicator2$subfield -->

	<!-- If a value is prefixed with: "log: " the value will not only be counted but gets an extra 
		named entry in the statistic file. -->
	<vars>
		<var name="ns-lobid-resource" value="http://lobid.org/resources/"/>
		<var name="ns-lobid-vocab" value="http://purl.org/lobid/lv#"/>
	</vars>
	<rules>
		<!-- Examples for sum AND NOT log values -->
		<data source="001-[-1].a" name="@id"/>
		<combine name="~rdf:subject" value="$[ns-lobid-resource]${id}#!">
			<data source="@id" name="id"/>
			<data source="700n[1-].?"/>
		</combine>
		<combine name="http://www.w3.org/1999/02/22-rdf-syntax-ns#type" value="${a}">
			<data source="700n[1-].?"/>
			<data source="@id" name="a">
				<regexp match=".*" format="http://purl.org/dc/terms/BibliographicResource"/>
		</data>
		</combine>
		<combine name="$[ns-lobid-vocab]hbzID" value="${a}">
			<data source="700n[1-].?"/>
			<data source="@id" name="a"/>
		</combine>
		<entity name="http://purl.org/dc/terms/spatial" reset="true" sameEntity="true" flushWith="700n-.b">
			<data source="700n-.a" name="http://700n-a"/>
			<data source="700n-.b" name="http://700n-b"/>
		</entity>
		<entity name="http://purl.org/dc/terms/spatial" reset="true" sameEntity="true" flushWith="700n1.b">
			<data source="700n1.a" name="http://700n1a"/>
			<data source="700n1.b" name="http://700n1b"/>
		</entity>
	</rules>
</metamorph>
